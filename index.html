<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Muslim Army Vision OS</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0a1f44;
      color: #66b2ff;
      overflow: hidden;
    }
    #camera {
      position: absolute;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: -1;
      filter: brightness(0.75) contrast(1.1);
    }
    #overlay {
      position: absolute;
      width: 100vw;
      height: 100vh;
      background: rgba(10, 31, 68, 0.4);
      pointer-events: none;
    }
    #header {
      position: absolute;
      top: 15px;
      left: 15px;
      background: rgba(0, 45, 115, 0.9);
      padding: 12px 25px;
      font-size: 20px;
      font-weight: bold;
      color: #a9d1ff;
      border-left: 5px solid #66b2ff;
      border-radius: 8px;
      box-shadow: 0 0 10px #3399ff;
      z-index: 10;
    }
    #info {
      position: absolute;
      bottom: 20px;
      left: 15px;
      background: rgba(0, 45, 115, 0.85);
      padding: 15px;
      border-radius: 10px;
      color: #cce4ff;
      font-size: 16px;
      max-width: 85vw;
      max-height: 150px;
      overflow-y: auto;
      white-space: pre-wrap;
      box-shadow: 0 0 12px #66b2ff;
      z-index: 10;
    }
    #status {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(0, 45, 115, 0.9);
      padding: 12px 20px;
      color: #66b2ff;
      font-weight: bold;
      border-radius: 8px;
      box-shadow: 0 0 8px #3399ff;
      z-index: 10;
    }
  </style>
</head>
<body>
  <video id="camera" autoplay muted playsinline></video>
  <div id="overlay"></div>
  <div id="header">üß† Muslim Army Vision OS</div>
  <div id="info">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡•§ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡ßÅ‡¶®...</div>
  <div id="status">üéôÔ∏è ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏: ‡¶∂‡ßÅ‡¶®‡¶õ‡¶ø...</div>

  <script>
    const camera = document.getElementById('camera');
    const info = document.getElementById('info');
    const status = document.getElementById('status');

    // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ ‡¶ì ‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶´‡ßã‡¶® ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ö‡¶æ‡¶≤‡ßÅ
    navigator.mediaDevices.getUserMedia({ video: true, audio: true })
      .then(stream => {
        camera.srcObject = stream;
      })
      .catch(err => {
        info.textContent = '‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ/‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶´‡ßã‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡ßü‡¶®‡¶ø: ' + err.message;
      });

    // Speech Recognition ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
      info.textContent = '‚ö†Ô∏è ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶≠‡ßü‡ßá‡¶∏ ‡¶∞‡¶ø‡¶ï‡¶ó‡¶®‡¶ø‡¶∂‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶®‡ßá‡¶á‡•§';
      throw new Error("SpeechRecognition not supported");
    }

    const recognition = new SpeechRecognition();
    recognition.lang = 'bn-BD';
    recognition.continuous = true;
    recognition.interimResults = false;

    recognition.onstart = () => {
      status.textContent = 'üéôÔ∏è ‡¶∂‡ßÅ‡¶®‡¶õ‡¶ø...';
    };

    recognition.onerror = (event) => {
      status.textContent = '‚ùå ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + event.error;
    };

    recognition.onend = () => {
      status.textContent = '‚ôªÔ∏è ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡ßü ‡¶∂‡ßÅ‡¶®‡¶õ‡¶ø...';
      recognition.start(); // ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡ßü ‡¶ö‡¶æ‡¶≤‡ßÅ
    };

    recognition.onresult = async (event) => {
      const text = event.results[event.results.length - 1][0].transcript.trim();
      info.textContent = `üîç ‡¶Ü‡¶™‡¶®‡¶ø ‡¶¨‡¶≤‡¶≤‡ßá‡¶®: "${text}"\nAI ‡¶ö‡¶ø‡¶®‡ßç‡¶§‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá...`;

      try {
        const encoded = encodeURIComponent(text);
        const res = await fetch(`https://chatgpt.apinepdev.workers.dev/?question=${encoded}`);
        const answer = await res.text();
        info.textContent = answer;

        // Speech Synthesis (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶®‡¶æ ‡¶™‡ßá‡¶≤‡ßá fallback)
        const speak = new SpeechSynthesisUtterance(answer);
        speak.lang = 'bn-BD';
        speak.onerror = () => {
          // fallback to English if ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶®‡¶æ ‡¶π‡ßü
          speak.lang = 'en-US';
          speechSynthesis.speak(speak);
        };
        speechSynthesis.cancel();
        speechSynthesis.speak(speak);

      } catch (err) {
        info.textContent = '‚ö†Ô∏è AI ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶Ü‡¶®‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá: ' + err.message;
      }
    };

    // ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
    recognition.start();
  </script>
</body>
</html>
